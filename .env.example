# ============================================================================
# SITE CONFIGURATION
# ============================================================================

# Site domain for frontend (Cloudflare Pages)
SITE_DOMAIN=elongoat.io

# API domain for backend (VPS Docker - api.elongoat.io)
API_DOMAIN=api.elongoat.io

# Public site URL (used for canonical/metadata)
NEXT_PUBLIC_SITE_URL=https://elongoat.io

# API URL for frontend to call backend (frontend/backend split)
NEXT_PUBLIC_API_URL=https://api.elongoat.io

# ============================================================================
# SECURITY CONFIGURATION (CRITICAL - SET STRONG VALUES IN PRODUCTION)
# ============================================================================
# P0: Startup validation will FAIL if any secret is set to default value
# Set VALIDATE_ENV_ON_STARTUP=0 to bypass validation (NOT RECOMMENDED)
# ============================================================================

# Admin token for content management (minimum 32 characters)
# Generate with: openssl rand -base64 48
ELONGOAT_ADMIN_TOKEN=your_long_random_token_at_least_32_chars

# Session secret for JWT signing (minimum 32 characters, different from admin token)
# Generate with: openssl rand -base64 48
ELONGOAT_ADMIN_SESSION_SECRET=your_session_secret_different_from_admin_token

# RAG API key for /api/rag/* endpoints (minimum 32 characters)
# Generate with: openssl rand -base64 48
ELONGOAT_RAG_API_KEY=your_rag_api_key_at_least_32_chars

# RAG cache configuration
RAG_CACHE_ENABLED=1
RAG_CACHE_TTL_SECONDS=3600

# Rate limiting configuration
RATE_LIMIT_ENABLED=1
RATE_LIMIT_API=100
RATE_LIMIT_API_WINDOW=60
RATE_LIMIT_CHAT=20
RATE_LIMIT_CHAT_WINDOW=3600
RATE_LIMIT_ADMIN=60
RATE_LIMIT_ADMIN_WINDOW=60
RATE_LIMIT_HEALTH=300
RATE_LIMIT_HEALTH_WINDOW=60
RATE_LIMIT_WHITELIST=
# CRITICAL: Rate limit IP signature secret (minimum 16 characters, must NOT be default)
# Generate with: openssl rand -base64 24
RATE_LIMIT_IP_SECRET=change_me_to_random_string

# HSTS preload configuration
# Production: Auto-enables preload with includeSubDomains (max-age=31536000)
# Set to 0 to disable preload in staging environments
# To submit to HSTS preload list: https://hstspreload.org/
HSTS_PRELOAD=false

# ============================================================================
# VectorEngine (server-only)
# ============================================================================
VECTORENGINE_API_KEY=ve_your_key_here
VECTORENGINE_BASE_URL=https://api.vectorengine.ai
# Optional: override full chat completions URL
# VECTORENGINE_API_URL=https://api.vectorengine.ai/v1/chat/completions
VECTORENGINE_MODEL=grok-4-fast-non-reasoning
VECTORENGINE_CONTENT_MODEL=claude-sonnet-4-5-20250929

# ============================================================================
# Dynamic variables (server-only; can be moved to Supabase later)
# ============================================================================
ELON_DOB=1971-06-28
ELON_CHILDREN_COUNT=14
ELON_NET_WORTH=Varies with markets (estimate; may be outdated).

# ============================================================================
# Chat config (server-only; supports hot update via elongoat.variables)
# ============================================================================
CHAT_MOOD=confident
CHAT_TYPING_QUIRK=1
CHAT_ANALYTICS_ENABLED=0

# ============================================================================
# Database (Optional - for persistent storage)
# ============================================================================
# Format: postgresql://USER:PASSWORD@SERVICE:PORT/DATABASE?schema=SCHEMA
DATABASE_URL=postgresql://user:pass@db:5432/postgres?schema=elongoat

# PostgreSQL pool configuration
PGPOOL_MAX=10
PG_STATEMENT_TIMEOUT_MS=60000

# Query cache configuration
QUERY_CACHE_ENABLED=1
QUERY_CACHE_TTL_MS=60000
QUERY_CACHE_MAX_SIZE=500

# ============================================================================
# Redis (Optional - recommended for rate limiting + chat cache)
# ============================================================================
REDIS_URL=redis://redis:6379/0

# Redis pool configuration
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY_MS=100
REDIS_CONNECT_TIMEOUT_MS=5000
REDIS_KEEP_ALIVE_MS=30000
REDIS_POOL_SIZE=5

# ============================================================================
# Tiered cache configuration
# ============================================================================
TIERED_CACHE_L1_TTL_MS=300000
TIERED_CACHE_L2_TTL_MS=3600000
TIERED_CACHE_L1_MAX_ENTRIES=1000
TIERED_CACHE_L1_CLEANUP_MS=60000
TIERED_CACHE_STAMP_TIMEOUT_MS=5000

# ============================================================================
# Content cache configuration
# ============================================================================
CONTENT_CACHE_L1_TTL_MS=300000
CONTENT_CACHE_L2_TTL_MS=3600000

# ============================================================================
# Embeddings (Vector Search) - Optional
# ============================================================================
# OpenAI API key for generating embeddings (or use VECTORENGINE_API_KEY)
OPENAI_API_KEY=sk-your_openai_key_here

# Embedding model configuration
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536
# EMBEDDING_BASE_URL=https://api.openai.com/v1

# ============================================================================
# Optional (future SEO tooling)
# ============================================================================
KEYWORDS_EVERYWHERE_API_KEY=your_key_here

# ============================================================================
# SOAX (SERP + web scraping) - server/worker only
# ============================================================================
SOAX_BASE_URL=https://scraping.soax.com
SOAX_API_SECRET=your_soax_secret
# SOAX_COUNTRY: Country code for proxy (e.g., "us", "gb", "de")
# Used by ingest_x.ts for fetch-content API
SOAX_COUNTRY=us
# SOAX_LOCATION: Full location name for SERP API (e.g., "United States", "United Kingdom")
# Used by ingest_videos.ts for google_videos API - falls back to SOAX_COUNTRY if not set
# SOAX_LOCATION=United States

# ============================================================================
# YouTube transcript worker configuration
# ============================================================================
TRANSCRIPT_BATCH_LIMIT=25
TRANSCRIPT_SLEEP_SECONDS=1.0
TRANSCRIPT_LANGUAGES=en
TRANSCRIPT_MAX_RETRIES=3
TRANSCRIPT_RETRY_DELAY=2.0

# ============================================================================
# Video ingest worker configuration
# ============================================================================
VIDEO_QUERIES=elon musk interview,elon musk spacex,elon musk tesla
VIDEO_LIMIT_PER_QUERY=10

# ============================================================================
# X (Twitter) ingest worker (optional; best-effort scraping may break)
# ============================================================================
X_HANDLES=elonmusk
X_MAX_TWEETS=60
X_INCLUDE_NON_AUTHOR=true
X_FETCH_FOLLOWING=false

# ============================================================================
# Performance & Monitoring
# ============================================================================
# Prometheus metrics endpoint token (optional - if set, requires Bearer auth)
METRICS_TOKEN=

# Security validation on startup (auto-enabled in production)
# Set to 0 to bypass startup validation (NOT RECOMMENDED)
VALIDATE_ENV_ON_STARTUP=1

# Cache warmup on startup
WARMUP_DELAY_MS=10
SKIP_WARMUP=0
